TWNSP.recommend={setRecommendSlider:function(){var a,b,c=$("#jsi-recommend-carousel-wrapper"),d=c.find(".jsc-carousel-lst"),e=d.children(),f=$(".recommend-lst-cassette").eq(0),g=0,h=TWNCMN.listSrchApiUrl,i=".recommend-lst-cassette-inner-search-result-num",j=function(){var a=navigator.userAgent;return a.indexOf("iPhone")>0||a.indexOf("iPod")>0||a.indexOf("Android")>0&&a.indexOf("Mobile")>0?"sp":"other"}();return{init:function(){var a=c.find(".recommend-lst-cassette-inner");a.removeClass("jsc-jump-link").addClass("jsc-jump-recommend-link"),TWNSP.recommend.setRecommendSlider.buildCarousel(),TWNSP.recommend.setRecommendSlider.getAjax(h,f),TWNSP.recommend.setRecommendSlider.flick()},buildCarousel:function(){d=c.find(".jsc-carousel-lst"),e=d.children();var f=e.length*c.width();d.css({width:f}),e.css({width:c.width()-68}),a?(a=new Flipsnap("#jsi-recommend-carousel-wrapper .jsc-carousel-lst",{disable3d:window.navigator.userAgent.indexOf("android")>-1,transitionDuration:700,distance:c.width()-58}),a.moveToPoint(b)):a=new Flipsnap("#jsi-recommend-carousel-wrapper .jsc-carousel-lst",{disable3d:window.navigator.userAgent.indexOf("android")>-1,transitionDuration:700,distance:c.width()-58})},getAjax:function(a,b){g=b.find(".jsc-jump-recommend-link").data("count-api-url"),a=a+"?"+g+TWNCMN.listSrchApiKey+TWNCMN.listSrchApiFrmt+TWNCMN.listSrchApiLimitNum+"&uacc=03",$.ajax({type:"post",url:a,dataType:"json",success:function(a){0!==parseInt(a.results.resultsAvailable)&&b.addClass("active"),b.find(i).addClass("hit");var c=String(a.results.resultsAvailable).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");b.find(i).text(c);var d=s_gi(s_account);d.linkTrackVars="eVar83",d.eVar83=c,d.tl(this,"o","Search count")}})},flick:function(){var c,d,e,f,g=$("#jsi-recommend-carousel-wrapper"),k=g.find(".jsc-carousel-lst"),l=k.children(),m=(l.length*g.width(),!0);$(document).on("click","#jsi-recommend-carousel-wrapper .recommend-lst-cassette .jsc-jump-link",function(){return!1}),$("#jsi-recommend-carousel-wrapper .recommend-lst-cassette").on({"touchstart mousedown":function(a){a.preventDefault(),"sp"===j?e=a.originalEvent.changedTouches[0].pageX:"other"===j&&(e=a.pageX),d="",c=$(this),m=!1},"touchmove mousemove":function(a){a.preventDefault(),"sp"===j?f=a.originalEvent.changedTouches[0].pageX:"other"===j&&(f=a.pageX),e-f>0&&"--"===c.next().find(i).text()&&(d="left"),m=!0},"touchend mouseup":function(){if("left"===d&&TWNSP.recommend.setRecommendSlider.getAjax(h,c.next()),!m){var a=c.find(".jsc-jump-recommend-link").data("jump-param");a="/"+a.replace(",","/"),"0"!==c.find(i).text()&&(window.location.href=a)}m=!0}}),a.element.addEventListener("fstouchend",function(a){b=a.newPoint},!1)}}}(),itemRecommendSlider:function(){var a=$("#jsi-recommend-add-little-carousel-wrapper"),b=a.find(".jsc-recommend-add-little-carousel-lst"),c=b.children(),d=$("#jsi-recommend-btn .btn-add-recommend"),e=$(".jsc-add-little-recommend-num"),f=0,g=c.length,h=0,i=0,j=($(window).width(),""),k=4;return $('#jsi-recommend-btn button input[name!="svos"]').each(function(){j+=$(this).attr("name")+"="+$(this).val()+"&"}),j=j.substr(0,j.length-1),{init:function(){TWNSP.recommend.itemRecommendSlider.split(),b.css({width:h})},submitAction:function(){return d.hasClass("active")?($('form[name="joSrchRsltListActionForm"]').submit(),void 0):!1},split:function(){var a,c,d=0,e=0,f=$(window);if(g>k){b.css("height"," 78px"),c=Math.floor(g/2),rest=g%2,c+=rest;for(var i=0;c>i;i++)d+=b.find(".add-little-recommend-lst-item-inner").eq(i).width(),i===c-1&&(b.find(".add-little-recommend-lst-item-inner").eq(i).addClass("upperlastcassette"),b.find(".add-little-recommend-lst-item-inner").eq(i).after("<br>"));for(var j=c;g>j;j++)e+=b.find(".add-little-recommend-lst-item-inner").eq(j).width(),j===g-1&&b.find(".add-little-recommend-lst-item-inner").eq(j).addClass("lowerlastcassette");h=e>d?e+6*(g-c):d+6*c}else{b.css("height"," 40px"),c=g;for(var i=0;g>i;i++)h+=b.find(">div").eq(i).width(),i===g-1&&b.find(".add-little-recommend-lst-item-inner").eq(i).addClass("lastcassette");h+=6*g}h+=6*Math.floor(g/2),h>f.outerWidth()&&(a=new Flipsnap(".jsc-recommend-add-little-carousel-lst",{maxPoint:c,distance:(h-f.outerWidth())/c}))},animationCounter:function(a){var b=a,c="&"+b.find("input").attr("name")+"="+b.find("input").val(),g=TWNCMN.listSrchApiUrl;if(b.find("input").prop("checked"))b.addClass("selected"),j+=c,g=g+"?"+j+TWNCMN.listSrchApiKey+TWNCMN.listSrchApiFrmt+TWNCMN.listSrchApiLimitNum+"&uacc=03",$.ajax({type:"post",url:g,dataType:"json",success:function(a){i=a.results.resultsAvailable,$({count:f}).animate({count:i},{duration:400,easing:"linear",progress:function(){var a=String(Math.ceil(this.count)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");e.text(a)}}),f=i,0===f?d.removeClass("active").addClass("disabled"):d.addClass("active").removeClass("disabled")}});else{var h=!0;b.removeClass("selected"),j=j.replace(c,""),g=g+"?"+j+TWNCMN.listSrchApiKey+TWNCMN.listSrchApiFrmt+TWNCMN.listSrchApiLimitNum+"&uacc=03",$(".add-little-recommend-lst-item-wrap .add-little-recommend-lst-item-inner").each(function(){$(this).find("input").prop("checked")&&(h=!1)}),h?(i=0,$({count:f}).animate({count:i},{duration:400,easing:"linear",progress:function(){var a=String(Math.ceil(this.count)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");e.text(a)}}),f=i,0===f?d.removeClass("active").addClass("disabled"):d.addClass("active").removeClass("disabled")):$.ajax({type:"post",url:g,dataType:"json",success:function(a){i=a.results.resultsAvailable,$({count:f}).animate({count:i},{duration:400,easing:"linear",progress:function(){var a=String(Math.ceil(this.count)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");e.text(a)}}),f=i,0===f?d.removeClass("active").addClass("disabled"):d.addClass("active").removeClass("disabled")}})}}}}()},$("#jsi-recommend-carousel-wrapper").length&&TWNSP.recommend.setRecommendSlider.init(),$("#jsi-recommend-add-little-carousel-wrapper").length&&TWNSP.recommend.itemRecommendSlider.init(),$(window).on("resize",function(){$("#jsi-recommend-carousel-wrapper").length&&TWNSP.recommend.setRecommendSlider.init()});var resultNum=0;$(".add-little-recommend-lst-item-inner input").on("change",function(){var a=$(this).closest(".add-little-recommend-lst-item-inner");TWNSP.recommend.itemRecommendSlider.animationCounter(a)}),$(".btn-add-recommend").on("click",function(a){return TWNSP.recommend.itemRecommendSlider.submitAction(a),!1});